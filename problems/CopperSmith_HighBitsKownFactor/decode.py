# -*- coding: UTF-8 -*- 
"""
对白：
Coppersmith:大牛，您好！我是Z集团的财务人员，负责给您汇款工作。
Ransom：您好！有什么事么？是不是要汇款过来？
Coppersmith：大牛，您好！我十分仰慕您，能开发出这么好的软件。我们集团准备把钱款汇给您，但在汇给您之前，我想先就这款软件请教您一下。
Ransom：不错嘛，积极配合，态度很好。想问什么问题，快点说，我比较忙。
Coppersmith：大牛，请问您这款软件用的RSA加密的模数n是多少bit？n的素数p是多少bit？能告诉我么？
Ransom:哈哈！使用的模数n是1648bit，素数p是1024bit。哎呀！我手机收到其他公司的付款了，真开心，这样吧，也不会担心您能破解，我给您发个文件，里面包含关于模数n和素数q以及你们集团的加密数据文件的密文。凉您有三头六臂也破解不了。哈哈！我先提款了，不和你磨叽了。闪人！ 
Coppersmith刚想还问，结果Ransom发来了一个txt文件，他接收后在虚拟机里打开一看，他的眼睛再次瞬间发出亮光，心里念着：今年的绩效奖金5倍呀！
每过多久，他解密了加密的数据文件。密文就是flag。"""
import libnum
#模数
n = 15048284507909673555125381197375333243656053602388632284987325177932040689737522946513540586940572971877388996407809322885752949102824083458355890094379944365118827838220563988817888089341954829750699661089437224927544924300384700206743812746518849798037498162356734588859683549561371384519160060492329713837134867236211673337007765409765754827503338631381163572514068047403527580784539155679459892503774077779843006318926247568991822542997624507875091182959388314444217981382332569572401482337607958385920022412253122000667575650561249706234280500871586807435096005515678675534355303700664843787399453588597250681107

#素数p的部分字节
p = 0xc9c8f6b0bdd39dc243f9fa52b44338b9de1ff8e634d7dd658406a62b87dcb8b106e3f8ac9ceb5a756440f9ac52dbb5d9c795d35967068f86d803ae4a12fff3ccd3b0fabb27d8ea9e62ef87afd4f25766625d2b994

#密文
c = 0x21bf98b815dd4cbf540a85e2718696e5740f0c21e918315269d7abf257b75e371c9d831bf196425774e10713db8e492b43879df44fd86b20d4dcb9b64846198e80589f18f18c4f718e0d841aaa2dea87a536fbab988fae27be141ee90021df3932aa7f4cf6f08cd3f5232b374d51402230ed5f7c6840d8fabeb5a906987f642339c5fc0290e3790f4bbaee8fbce08239e388e3a4bae6c8a85addd4361ede1cbe7d7b2dc3f544416593d191766f6dba6b21aae18ccfea7361284ec3d20730c9d9c9c2527e85d2b877ddc046223c8977775da6a7aa7eb805e55e20224402eb1bb6f4560341b74d12b6e12b63c964d24aa9f60eeba4fe251d32eb8d958159cb5141
#print len(bin(p)[2:])
#print bin(p)
p = 0xc9c8f6b0bdd39dc243f9fa52b44338b9de1ff8e634d7dd658406a62b87dcb8b106e3f8ac9ceb5a756440f9ac52dbb5d9c795d35967068f86d803ae4a12fff3ccd3b0fabb27d8ea9e62ef87afd4f25766625d2b994216794fa7fd01301fd7809bea598778b7316958adeb00fdb537ce48ad49304edf21f959260bfd8335c3c7edL
q = 0x973bad5b8ac897c156f9cca97c6da790aeff097553bb938cb931bb9d8c60089f4f7a46f86aa5639c5aacbd642614b8fda6e099a4eb9250d2cdedc74a342088408594083bdd767f58d8e317598af1bcdf8754e1b185741364d3db1e7eda1700af0ab8c764372dda8ac9a3c0bb8adde4d426b558b8b91c7c4fd26203929cdfd4ffL
e = 65537
phi = (p-1)*(q-1)
d = libnum.invmod(e,phi)
print libnum.n2s(pow(c,d,n))