import sys
from sage.all import *
import binascii
n = 0x595213e8b5e2e249bb3875b51de7c6d28d3dccc0a176c3cf6f3e3d3caed0c3050d9cf6e9b61245aefbea04fdcbac2e4e4495366042f490a6de7a3a736b56afd3284279ff2a972481419c3fce40116d19090b1db4829fac3e124bb8527f07e770ba9f5514a9ffe468db182de7f68331f462d2adaf34534df2c1633a267bd9a2b3da6777ea95d724efd475643da40b2515f9130abda8b633aa9317d64e61c82d7b6f338e09c29797b07ce6eccffbc63ecb81231982e745233df2334c115cbb054ef82483bbb223cf2e62a26f12b2f64aa666c8d1ad2a274590225d4940243c0909bbe1bcd8a99c8f9fb53e3f83a4ecb40effa7277d334fac6266e3187e8a0a2117
cipher = 0x1ca631d4bb67ad287e1fb7e938726cf9814eebb4899633e9bf326ab2468c66b15633a4ec015cb3a6ff1313daaeecef9892c5a7b9dda6148d8c2a70fff22e77d443ebb37114d06e4ee7462ffb4573ffa9c9983dafab8fbd24902389674071fdd9b561977ccfca3cdffc5fb1e38923db3929cc712cbf191ad7b4d41b7f665bf4c2f18f814ae8d2d1d606697699e1aef4d22971bdae83f5f519986e2fc55e906bb9aa2fadb37ad2ae7c17a5b21fd4ac2172db3062d956714c867894640e257e3b00a47772e25b5d574c84325a7ae1f65b574fd8efdb6fb8106ab9f10b5efa0dc8c70b743482058722c296feb12d658b495af817a96f3cf6688f6f642628fc791f3f
#cipher = int(sys.argv[1])
e = 0x10001

p1=0xc8e15e451066c74d2e412ab6aafc03125747e94c8fae6f5b2dcb4569f3b0ca81a02c5766d3aa99cda2d311157c68d493ad372071121a5dc1eb3bb58eb00cbaf9add9b1c4ebfa392712c07c977df1ebd61e7f14d8c1d3ba5db219<<304

PR.<x> = PolynomialRing(Zmod(n))
f = x+p1
roots = f.small_roots(X=2^448, beta=0.4)
if roots:
    print "x: ", hex(int(roots[0]))